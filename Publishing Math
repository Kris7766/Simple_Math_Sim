#include <iostream>
#include <ros/ros.h>
#include <std_msgs/String.h>
#include <std_msgs/Int8.h>

//Publisher
ros::Publisher pub_Regnestykke_v1;
ros::Publisher pub_Regnestykke_v2;
ros::Publisher pub_Regnestykke_op1;
ros::Publisher pub_Resultat;

//Variabler
int v1, v2, op1, mat, a = 1;

//std msg navne
std_msgs::String msg;
std::stringstream ss1, ss2;
std_msgs::Int8 msg_v1, msg_v2, msg_op1, msg_res;

//main function
int main(int argc, char **argv)
{
    ros::init (argc, argv, "Math");
    ros::NodeHandle n;
    pub_Regnestykke_v1 = n.advertise<std_msgs::Int8>("Regnestykke", 1000);
    pub_Regnestykke_v2 = n.advertise<std_msgs::Int8>("Regnestykke", 1000);
    pub_Regnestykke_op1 = n.advertise<std_msgs::Int8>("Regnestykke", 1000);
    pub_Resultat = n.advertise<std_msgs::Int8>("Resultat", 1000);

    while (a != 0 && ros::ok())
    {
        std::cout << "Indtast første værdi her: ";
        std::cin >> v1;
        std::cout << "\nVælg operation; + = 1   - = 2   * = 3   / = 4: ";
        std::cin >> op1;
        std::cout << "\nIndtast anden værdi her: ";
        std::cin >> v2;

        if (op1 == 1)
        {
            std::cout << v1 << " + " << v2 << " = ";
            mat = v1 + v2;
            std::cout << mat << std::endl;
            ss1 << v1 << " + " << v2 << std::endl;
        }

        else if (op1 == 2)
        {
            std::cout << v1 << " - " << v2 << " = ";
            mat = v1 - v2;
            std::cout << mat << std::endl;
            ss1 << v1 << " - " << v2 << std::endl;
        }

        else if (op1 == 3)
        {
            std::cout << v1 << " * " << v2 << " = ";
            mat = v1 * v2;
            std::cout << mat << std::endl;
            ss1 << v1 << " * " << v2 << std::endl;
        }

        else if (op1 == 4)
        {
            std::cout << v1 << " / " << v2 << " = ";
            mat = v1 / v2;
            std::cout << mat << std::endl;
            ss1 << v1 << " / " << v2 << std::endl;
        }

        /*
        ss2 << mat << std::endl;

        msg.data = ss1.str();
        ROS_INFO("%s", msg.data.c_str());
        pub_Regnestykke.publish(msg);
        
        msg.data = ss2.str();
        ROS_INFO("%s", msg.data.c_str());
        pub_Resultat.publish(msg);
        */

        msg_v1.data = v1;
        ROS_INFO("%d", msg_v1.data);
        pub_Regnestykke_v1.publish(msg_v1);

        msg_v2.data = v2;
        ROS_INFO("%d", msg_v2.data);
        pub_Regnestykke_v2.publish(msg_v2);

        msg_op1.data = op1;
        ROS_INFO("%d", msg_op1.data);
        pub_Regnestykke_op1.publish(msg_op1);

        msg_res.data = mat;
        ROS_INFO("%d", msg_res.data);
        pub_Resultat.publish(msg_res);

        ros::spinOnce();

        std::cout << "Tast 0 for at afslutte alt andet for at fortsætte: ";
        std::cout << ss1.str() << std::endl;
        std::cin >> a;
    }

    return 0;
}
